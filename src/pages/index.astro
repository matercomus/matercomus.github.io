---
import { getCollection } from 'astro:content';
import { HeroSection } from '../components/HeroSection';
import { PostCard } from '../components/PostCard';
import { Button } from '../components/ui/button';
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import profileImage from '../assets/matt-drinking-coffee.jpg';

const posts = (await getCollection('blog'))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<HeroSection 
		client:load
		name="Mateusz Kędzia"
		title="AI/ML Engineer & Research Scientist"
		description="Specializing in autonomous agents, LLM-powered applications, and scalable AI systems. Building intelligent solutions at the intersection of research and production."
		imageSrc={profileImage.src}
		imageAlt="Photo of Mateusz Kędzia"
		buttons={[
			{ href: '/blog', text: 'Blog', variant: 'default' },
			{ href: '/cv/index.html', text: 'View CV', variant: 'secondary' },
			{ href: '/cv/index.zh.html', text: '中文简历', variant: 'outline' }
		]}
	/>

	<section class="container py-16">
		<div class="max-w-3xl mx-auto space-y-8">
			<h2 class="scroll-m-20 text-3xl font-bold tracking-tight">Latest Posts</h2>
			<div class="space-y-4">
				{posts.map((post) => (
					<PostCard 
						client:load
						href={`/blog/${post.id}/`}
						title={post.data.title}
						description={post.data.description}
						pubDate={post.data.pubDate}
					/>
				))}
			</div>
			<div class="flex justify-center">
				<Button variant="link" asChild>
					<a href="/blog">View all posts →</a>
				</Button>
			</div>
		</div>
	</section>
</BaseLayout>
